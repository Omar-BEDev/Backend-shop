{
  "openapi": "3.0.0",
  "info": {
    "title": "Eco Storefront API",
    "description": "Professional E-commerce REST API built with Express, TypeScript, and MongoDB. Features: Secure Auth, Batch Product Processing, and Admin Analytics.",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://backend-shop-practise-production.up.railway.app",
      "description": "Main Production Server"
    },
    {
      "url": "http://localhost:3000",
      "description": "Local Development Server"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "UserSignupInput": {
        "type": "object",
        "required": ["name", "nickname", "email", "password", "birthDate", "address"],
        "properties": {
          "name": { "type": "string", "example": "Ibrahim El" },
          "nickname": { "type": "string", "example": "ibra99" },
          "email": { "type": "string", "format": "email", "example": "ibra@test.com" },
          "password": { "type": "string", "minLength": 8, "example": "Password123!" },
          "birthDate": { "type": "string", "format": "date", "example": "1995-01-01" },
          "address": {
            "type": "object",
            "properties": {
              "country": { "type": "string", "example": "Morocco" },
              "city": { "type": "string", "example": "Agadir" }
            }
          }
        }
      },
      "AuthResponse": {
        "type": "object",
        "properties": {
          "message": { "type": "string", "example": "the login is succesfully" },
          "user": { "type": "string", "example": "Ibrahim" },
          "token": { "type": "string", "example": "eyJhbGci..." }
        }
      },
      "Product": {
        "type": "object",
        "required": ["name", "description", "price", "stock", "category"],
        "properties": {
          "name": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "stock": { "type": "number" },
          "category": { "type": "string" },
          "images": { "type": "array", "items": { "type": "string" } },
          "sku": { "type": "string", "readOnly": true }
        }
      },
      "OrderInput": {
        "type": "object",
        "required": ["userId", "items"],
        "properties": {
          "userId": { "type": "string", "description": "MongoDB ObjectId" },
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "productId": { "type": "string" },
                "quantity": { "type": "number" },
                "name": { "type": "string", "description": "Placeholder, server will overwrite" },
                "price": { "type": "number", "description": "Placeholder, server will overwrite" }
              }
            }
          },
          "discountValue": { "type": "number", "default": 0 }
        }
      }
    }
  },
  "paths": {
    "/api/users/signup": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Create a new user account",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UserSignupInput" } } }
        },
        "responses": {
          "200": { "description": "Account created", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AuthResponse" } } } }
        }
      }
    },
    "/api/users/login": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Login to existing account",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": { "type": "string" },
                  "password": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Login successful", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AuthResponse" } } } }
        }
      }
    },
    "/api/products": {
      "get": {
        "tags": ["Products"],
        "summary": "Get all active products",
        "responses": {
          "200": { "description": "Success", "content": { "application/json": { "schema": { "type": "object", "properties": { "products": { "type": "array", "items": { "$ref": "#/components/schemas/Product" } } } } } } }
        }
      }
    },
    "/api/products/add": {
      "post": {
        "tags": ["Admin - Products"],
        "security": [{ "bearerAuth": [] }],
        "summary": "Add new product",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Product" } } }
        },
        "responses": {
          "201": { "description": "Created" }
        }
      }
    },
    "/api/orders/add": {
      "post": {
        "tags": ["Orders"],
        "security": [{ "bearerAuth": [] }],
        "summary": "Create a new order",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/OrderInput" } } }
        },
        "responses": {
          "201": { "description": "Order successful", "content": { "application/json": { "schema": { "type": "object", "properties": { "message": { "type": "string" } } } } } }
        }
      }
    },
    "/api/orders/statistics": {
      "get": {
        "tags": ["Admin - Statistics"],
        "security": [{ "bearerAuth": [] }],
        "summary": "Get store statistics for admin dashboard",
        "responses": {
          "200": {
            "description": "Stats Data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "orders": { "type": "array", "items": { "type": "object" } },
                    "numOforders": { "type": "number" },
                    "completedOrders": { "type": "number" }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
